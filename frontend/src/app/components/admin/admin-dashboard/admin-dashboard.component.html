<div class="admin-container">
  <header class="dashboard-header">
    <h1>Admin Dashboard</h1>
    <div class="actions">
      <button class="btn-add" (click)="goToAddToy()">+ Add New Toy</button>
    </div>
  </header>

  <div class="stats-grid">
    <div class="stat-card">
      <h3>{{ toys.length }}</h3>
      <p>Total Toys</p>
    </div>
    <div class="stat-card">
      <h3>{{ reservations.length }}</h3>
      <p>Total Reservations</p>
    </div>
  </div>

  <div class="view-switcher">
    <button [class.active]="activeView === 'reservations'" (click)="activeView = 'reservations'">
      Reservations
    </button>
    <button [class.active]="activeView === 'inventory'" (click)="activeView = 'inventory'">
      Inventory Management
    </button>
  </div>

  <section class="management-section" *ngIf="activeView === 'reservations'">
    <div class="section-header">
      <h2>Reservation Management</h2>
    </div>

    <div *ngIf="reservations.length === 0" class="status-msg">
      No active reservations at the moment.
    </div>

    <div class="reservation-grid" *ngIf="reservations.length > 0">
      <div class="reservation-card" *ngFor="let r of reservations">
        <div class="reservation-header">
          <div class="user-info">
            <strong>{{ r.user?.fullName }}</strong>
            <span class="email">{{ r.user?.email }}</span>
          </div>
          <div class="status-badge" [attr.data-status]="r.status">
            {{ r.status }}
          </div>
        </div>

        <div class="reservation-items">
          <div class="item-row" *ngFor="let item of r.items">
            <img [src]="item.toy?.image" class="toy-thumb" *ngIf="item.toy?.image">
            <div class="item-details">
              <span class="toy-name">{{ item.toy?.name }}</span>
              <span class="qty"> x{{ item.quantity }}</span>
            </div>
          </div>
        </div>

        <div class="reservation-footer">
          <div class="total">
            Total: {{ calculateTotal(r) | currency:'EUR':'symbol':'1.2-2' }}
          </div>
          <div class="actions-buttons" *ngIf="r.status === 'reserved'">
            <button class="btn-arrived" (click)="onUpdateStatus(r._id, 'arrived')">Mark Arrived</button>
            <button class="btn-cancel" (click)="onUpdateStatus(r._id, 'canceled')">Cancel Order</button>
          </div>
          <div class="date">{{ r.createdAt | date:'medium' }}</div>
        </div>
      </div>
    </div>
  </section>

  <section class="management-section" *ngIf="activeView === 'inventory'">
    <div class="section-header">
      <h2>Toy Inventory</h2>
    </div>
    <div class="table-wrapper">
      <table class="admin-table">
        <thead>
          <tr>
            <th>Product</th>
            <th>Type</th>
            <th>Price</th>
            <th>Stock</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let toy of toys">
            <td class="product-cell">
              <img [src]="toy.image" class="toy-thumb-small">
              <span>{{ toy.name }}</span>
            </td>
            <td>{{ toy.type }}</td>
            <td>{{ toy.price | currency:'EUR' }}</td>
            <td>
              <span class="stock-badge" [class.low-stock]="toy.inStock < 5">
                {{ toy.inStock }}
              </span>
            </td>
            <td class="actions-cell">
              <button class="btn-icon edit" (click)="onEditToy(toy)">‚úé</button>
              <button class="btn-icon delete" (click)="onDeleteToy(toy._id)">üóë</button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </section>

  <div class="modal-overlay" *ngIf="showModal" (click)="closeModal()">
    <div class="modal-card" (click)="$event.stopPropagation()">
      <div class="modal-icon" [ngClass]="modalType">
        <span *ngIf="modalType === 'danger'">‚ö†Ô∏è</span>
        <span *ngIf="modalType === 'success'">‚úÖ</span>
      </div>
      <h2>{{ modalTitle }}</h2>
      <p>{{ modalMessage }}</p>
      <div class="modal-actions">
        <button class="btn-secondary" (click)="closeModal()">Cancel</button>
        <button *ngIf="modalType === 'danger'" class="btn-danger-action" (click)="confirmAction()">Confirm Delete</button>
        <button *ngIf="modalType === 'success'" class="btn-primary-action" (click)="closeModal()">Ok</button>
      </div>
    </div>
  </div>
</div>