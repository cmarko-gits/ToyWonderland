<div class="container">
  <div class="filters-wrapper">
    <div class="search-box">
      <input type="text" [(ngModel)]="search" (input)="onFilterChange()" placeholder="Pretraži igračke...">
    </div>

    <div class="select-group">
      <select [(ngModel)]="selectedCategory" (change)="onFilterChange()">
        <option value="">Sve kategorije</option>
        <option *ngFor="let c of categories" [value]="c">{{ c }}</option>
      </select>

      <select [(ngModel)]="selectedAgeGroup" (change)="onFilterChange()">
        <option value="">Uzrast</option>
        <option *ngFor="let a of ageGroups" [value]="a">{{ a }}</option>
      </select>

      <select [(ngModel)]="selectedTargetGroup" (change)="onFilterChange()">
        <option value="">Pol</option>
        <option *ngFor="let t of targetGroups" [value]="t">{{ t }}</option>
      </select>
    </div>

    <div class="price-sort-row">
      <div class="price-group">
        <input type="number" [(ngModel)]="minPrice" (input)="onFilterChange()" placeholder="Min €">
        <input type="number" [(ngModel)]="maxPrice" (input)="onFilterChange()" placeholder="Max €">
      </div>

      <div class="sort-box">
        <select [(ngModel)]="sortOption" (change)="onFilterChange()">
          <option value="">Sortiraj</option>
          <option value="price_asc">Cena: Rastuće</option>
          <option value="price_desc">Cena: Opadajuće</option>
          <option value="newest">Najnovije</option>
        </select>
      </div>
    </div>
  </div>

  <div *ngIf="!loading; else loadingTemplate" class="toys-grid">
    <div class="toy-card" *ngFor="let toy of toys">
      <span class="favorite-icon" [class.active]="toy.isFavorite" (click)="toggleFavorite(toy, $event)">
        ♥
      </span>
      
      <div class="image-container" (click)="openToy(toy._id)">
        <img [src]="toy.image" [alt]="toy.name">
      </div>

      <div class="card-body">
        <h3>{{ toy.name }}</h3>
        <p class="price">{{ toy.price | currency:'EUR' }}</p>
        <button class="add-btn" (click)="addToCart(toy._id)">
          Dodaj u korpu
        </button>
      </div>
    </div>
  </div>

  <div class="pagination" *ngIf="!loading && totalPages > 1">
    <button (click)="changePage(false)" [disabled]="page === 1" class="page-btn">←</button>
    <span class="page-info">Strana <strong>{{ page }}</strong> od {{ totalPages }}</span>
    <button (click)="changePage(true)" [disabled]="page === totalPages" class="page-btn">→</button>
  </div>

  <ng-template #loadingTemplate>
    <div class="loader-container">
      <div class="loader"></div>
      <p>Otkrivamo magiju igračaka...</p>
    </div>
  </ng-template>
</div>